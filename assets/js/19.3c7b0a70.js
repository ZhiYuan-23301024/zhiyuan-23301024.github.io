(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{459:function(t,s,a){t.exports=a.p+"assets/img/file-20250916190751019.baeb2014.png"},460:function(t,s,a){t.exports=a.p+"assets/img/file-20250916190752777.e4b3f26d.png"},461:function(t,s,a){t.exports=a.p+"assets/img/file-20250916190753137.2d30fb1c.png"},579:function(t,s,a){"use strict";a.r(s);var n=a(2),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[s("a",{attrs:{href:"https://liaoxuefeng.com/books/java/springcloud/project/index.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("搭建项目框架 - Java教程 - 廖雪峰的官方网站"),s("OutboundLink")],1),t._v("v\n"),s("a",{attrs:{href:"https://github.com/forezp/SpringCloudLearning",target:"_blank",rel:"noopener noreferrer"}},[t._v("forezp/SpringCloudLearning: 《史上最简单的Spring Cloud教程源码》"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://blog.csdn.net/sinat_38967565/article/details/137171388?spm=1001.2014.3001.5501",target:"_blank",rel:"noopener noreferrer"}},[t._v("【Spring Cloud Alibaba】基于Spring Boot 3.x 搭建教程-CSDN博客"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"可以做什么亮点"}},[t._v("可以做什么亮点")]),t._v(" "),s("p",[s("strong",[t._v("性能方面")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"left"}},[t._v("优化方向")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("具体方法")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("预期收益与效果")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("strong",[t._v("数据库连接池")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("参数调优（最大/最小连接数、超时时间）、连接复用、泄漏检测、健康检查")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("降低延迟（如从200ms降至20ms），提高吞吐量，避免连接耗尽")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("strong",[t._v("代码层面")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("选择合适的数据结构、避免不必要的计算、使用局部变量、减少对象创建")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("减少内存消耗，提高代码执行效率")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("strong",[t._v("缓存策略")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("合理应用缓存（如 Redis、Memcached）、客户端缓存、CDN 缓存")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("减轻数据库压力，加快响应速度，提升系统吞吐量")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("strong",[t._v("异步处理")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("异步编程、消息队列")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("提升系统吞吐量，特别是对于I/O密集型操作")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("strong",[t._v("系统架构")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("微服务架构、负载均衡")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("提高系统可扩展性和可用性")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("strong",[t._v("监控与排查")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("日志记录、性能监控工具（如 Prometheus、Grafana）")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("快速定位性能瓶颈，便于持续优化")])])])]),t._v(" "),s("p",[s("strong",[t._v("设计模式？")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("场景")]),t._v(" "),s("th",[t._v("推荐模式")]),t._v(" "),s("th",[t._v("优点")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("全局唯一对象")]),t._v(" "),s("td",[t._v("单例模式")]),t._v(" "),s("td",[t._v("节省资源，统一管理")])]),t._v(" "),s("tr",[s("td",[t._v("对象创建复杂")]),t._v(" "),s("td",[t._v("工厂模式")]),t._v(" "),s("td",[t._v("解耦创建逻辑")])]),t._v(" "),s("tr",[s("td",[t._v("接口不兼容")]),t._v(" "),s("td",[t._v("适配器模式")]),t._v(" "),s("td",[t._v("重用现有代码")])]),t._v(" "),s("tr",[s("td",[t._v("动态添加功能")]),t._v(" "),s("td",[t._v("装饰器模式")]),t._v(" "),s("td",[t._v("灵活扩展")])]),t._v(" "),s("tr",[s("td",[t._v("多种算法选择")]),t._v(" "),s("td",[t._v("策略模式")]),t._v(" "),s("td",[t._v("易于切换算法")])]),t._v(" "),s("tr",[s("td",[t._v("事件通知")]),t._v(" "),s("td",[t._v("观察者模式")]),t._v(" "),s("td",[t._v("松耦合通信")])]),t._v(" "),s("tr",[s("td",[t._v("数据访问抽象")]),t._v(" "),s("td",[t._v("仓储模式")]),t._v(" "),s("td",[t._v("分离业务与数据逻辑")])]),t._v(" "),s("tr",[s("td",[t._v("解耦依赖")]),t._v(" "),s("td",[t._v("依赖注入")]),t._v(" "),s("td",[t._v("提高可测试性")])])])]),t._v(" "),s("h2",{attrs:{id:"设计思路"}},[t._v("设计思路")]),t._v(" "),s("h3",{attrs:{id:"一、技术架构设计"}},[t._v("一、技术架构设计")]),t._v(" "),s("h4",{attrs:{id:"_1-核心框架选型"}},[t._v("1. 核心框架选型")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("技术组件")]),t._v(" "),s("th",[t._v("作用")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("Spring Boot 3")]),t._v(" "),s("td",[t._v("快速构建RESTful API，集成安全、数据库等模块")])]),t._v(" "),s("tr",[s("td",[t._v("MyBatis-Plus")]),t._v(" "),s("td",[t._v("简化数据库CRUD操作，支持动态表名、多租户等特性")])]),t._v(" "),s("tr",[s("td",[t._v("Spring Cloud Alibaba")]),t._v(" "),s("td",[t._v("实现微服务治理（服务注册/发现、配置中心、熔断降级）")])]),t._v(" "),s("tr",[s("td",[t._v("Redis")]),t._v(" "),s("td",[t._v("缓存号源状态、用户会话、分布式锁")])]),t._v(" "),s("tr",[s("td",[t._v("MySQL 8.0")]),t._v(" "),s("td",[t._v("存储结构化数据（用户、医生、订单等）")])]),t._v(" "),s("tr",[s("td",[t._v("RabbitMQ")]),t._v(" "),s("td",[t._v("异步处理支付回调、消息通知等任务")])])])]),t._v(" "),s("h4",{attrs:{id:"_2-系统分层架构"}},[t._v("2. 系统分层架构")]),t._v(" "),s("p",[s("img",{attrs:{src:a(459),alt:""}})]),t._v(" "),s("hr"),t._v(" "),s("h3",{attrs:{id:"二、核心功能模块设计"}},[t._v("二、核心功能模块设计")]),t._v(" "),s("h4",{attrs:{id:"_1-用户服务"}},[t._v("1. 用户服务")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("​"),s("strong",[t._v("功能")]),t._v("​：注册/登录、实名认证、就诊人管理")])]),t._v(" "),s("li",[s("p",[t._v("​"),s("strong",[t._v("关键实现")]),t._v("​：")]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 用户注册（密码加密存储）")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@PostMapping")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/register"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Result")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("register")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@RequestBody")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("User")]),t._v(" user"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    user"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setPassword")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("passwordEncoder"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("encode")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("user"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getPassword")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" userService"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("save")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("user"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br")])])]),t._v(" "),s("li",[s("p",[t._v("​"),s("strong",[t._v("安全设计")]),t._v("​：JWT令牌鉴权 + Spring Security权限控制")])])]),t._v(" "),s("h4",{attrs:{id:"_2-号源服务"}},[t._v("2. 号源服务")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("​"),s("strong",[t._v("核心逻辑")]),t._v("​：")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("号源状态实时更新（Redis Bitmap位操作）")])]),t._v(" "),s("li",[s("p",[t._v("分布式锁防止超卖（Redisson框架）")])])]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 号源预约（Redis乐观锁）")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("boolean")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("reserveSlot")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" slotId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RAtomicLong")]),t._v(" remain "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" redisson"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getAtomicLong")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"slot:"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" slotId "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('":remain"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),t._v(" current "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" remain"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("decrementAndGet")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("current "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        remain"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("incrementAndGet")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 回滚")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br")])])]),t._v(" "),s("li",[s("p",[t._v("​"),s("strong",[t._v("数据表")]),t._v("​："),s("code",[t._v("schedule")]),t._v("（排班表）、"),s("code",[t._v("slot")]),t._v("（号源表）")])])]),t._v(" "),s("h4",{attrs:{id:"_3-订单服务"}},[t._v("3. 订单服务")]),t._v(" "),s("ul",[s("li",[t._v("​"),s("strong",[t._v("状态机设计")]),t._v("​：")])]),t._v(" "),s("p",[s("img",{attrs:{src:a(460),alt:""}})]),t._v(" "),s("ul",[s("li",[t._v("​"),s("strong",[t._v("支付对接")]),t._v("​：微信支付/支付宝异步回调处理")])]),t._v(" "),s("h4",{attrs:{id:"_4-医生服务"}},[t._v("4. 医生服务")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("​"),s("strong",[t._v("排班管理")]),t._v("​：")]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 医生排班规则（Cron表达式）")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Scheduled")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cron "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0 0 0 * * ?"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 每天0点生成号源")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("generateSlots")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    doctorSchedules"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("schedule "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" slots "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("calculateAvailableSlots")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("schedule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        slotService"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createSlots")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("schedule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" slots"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br")])])])]),t._v(" "),s("hr"),t._v(" "),s("h3",{attrs:{id:"三、数据库设计-mysql示例"}},[t._v("三、数据库设计（MySQL示例）")]),t._v(" "),s("h4",{attrs:{id:"_1-核心表结构"}},[t._v("1. 核心表结构")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("表名")]),t._v(" "),s("th",[t._v("字段示例")]),t._v(" "),s("th",[t._v("索引策略")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("code",[t._v("user")])]),t._v(" "),s("td",[t._v("id, username, password, role")]),t._v(" "),s("td",[t._v("username唯一索引")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("doctor")])]),t._v(" "),s("td",[t._v("id, name, department_id, title")]),t._v(" "),s("td",[t._v("department_id索引")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("schedule")])]),t._v(" "),s("td",[t._v("id, doctor_id, date, status")]),t._v(" "),s("td",[t._v("(doctor_id,date)联合索引")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("slot")])]),t._v(" "),s("td",[t._v("id, schedule_id, time_segment")]),t._v(" "),s("td",[t._v("schedule_id索引")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("appointment")])]),t._v(" "),s("td",[t._v("id, user_id, slot_id, status")]),t._v(" "),s("td",[t._v("(slot_id,status)联合索引")])])])]),t._v(" "),s("h4",{attrs:{id:"_2-关键sql示例"}},[t._v("2. 关键SQL示例")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- 号源余量查询（带缓存）")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" remaining "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" slot_remaining \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" slot_id"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#{slotId} ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FOR")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("UPDATE")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- 行级锁防止并发超卖")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- 预约记录插入")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INSERT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INTO")]),t._v(" appointment"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("user_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" slot_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("status")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("VALUES")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#{userId}, #{slotId}, 'PAID')")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DUPLICATE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("KEY")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("UPDATE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("status")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("VALUES")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("status")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br")])]),s("hr"),t._v(" "),s("h3",{attrs:{id:"四、高并发优化策略"}},[t._v("四、高并发优化策略")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("​"),s("strong",[t._v("缓存设计")]),t._v("​：")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("热门科室号源缓存（Redis过期时间动态调整）")])]),t._v(" "),s("li",[s("p",[t._v("医生信息缓存（Guava本地缓存 + Redis集群）")])])])]),t._v(" "),s("li",[s("p",[t._v("​"),s("strong",[t._v("限流降级")]),t._v("​：")]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 令牌桶限流（Guava RateLimiter）")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RateLimiter")]),t._v(" limiter "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RateLimiter")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("create")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 每秒1000请求")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("limiter"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("tryAcquire")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RateLimitException")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"系统繁忙，请稍后重试"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br")])])]),t._v(" "),s("li",[s("p",[t._v("​"),s("strong",[t._v("异步处理")]),t._v("​：")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("支付回调异步化（RabbitMQ死信队列）")])]),t._v(" "),s("li",[s("p",[t._v("短信通知批量发送")])])])])]),t._v(" "),s("hr"),t._v(" "),s("h3",{attrs:{id:"五、安全与监控"}},[t._v("五、安全与监控")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("​"),s("strong",[t._v("安全措施")]),t._v("​：")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("敏感数据脱敏（如手机号显示为138_​__​_5678）")])]),t._v(" "),s("li",[s("p",[t._v("防SQL注入（MyBatis参数化查询）")])]),t._v(" "),s("li",[s("p",[t._v("定期安全审计（OWASP ZAP扫描）")])])])]),t._v(" "),s("li",[s("p",[t._v("​"),s("strong",[t._v("监控体系")]),t._v("​：")]),t._v(" "),s("p",[s("img",{attrs:{src:a(461),alt:""}})])])]),t._v(" "),s("hr"),t._v(" "),s("h3",{attrs:{id:"六、扩展性设计"}},[t._v("六、扩展性设计")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("​"),s("strong",[t._v("微服务拆分")]),t._v("​：")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("用户中心（Auth Service）")])]),t._v(" "),s("li",[s("p",[t._v("号源中心（Slot Service）")])]),t._v(" "),s("li",[s("p",[t._v("订单中心（Order Service）")])]),t._v(" "),s("li",[s("p",[t._v("医生中心（Doctor Service）")])])])]),t._v(" "),s("li",[s("p",[t._v("​"),s("strong",[t._v("多院区支持")]),t._v("​：")]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 多租户数据隔离")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@TenantScope")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SlotService")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 根据tenantId切换数据源")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br")])])])]),t._v(" "),s("hr"),t._v(" "),s("h3",{attrs:{id:"七、部署建议"}},[t._v("七、部署建议")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("​"),s("strong",[t._v("容器化部署")]),t._v("​：")]),t._v(" "),s("div",{staticClass:"language-docker line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-docker"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Dockerfile示例")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token instruction"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" openjdk:17-jdk-slim")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token instruction"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COPY")]),t._v(" target/hospital-system.jar app.jar")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token instruction"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENTRYPOINT")]),t._v(" ["),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"java"')]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-jar"')]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/app.jar"')]),t._v("]")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])])]),t._v(" "),s("li",[s("p",[t._v("​"),s("strong",[t._v("CI/CD流水线")]),t._v("​：")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("Jenkins/GitLab CI自动构建")])]),t._v(" "),s("li",[s("p",[t._v("ArgoCD持续部署到K8s集群")])])])])]),t._v(" "),s("hr"),t._v(" "),s("p",[t._v("通过以上设计，系统可支撑"),s("strong",[t._v("日均10万+挂号量")]),t._v("，核心接口响应时间<200ms。实际开发中需根据医院具体需求调整模块优先级，例如三甲医院需强化数据分析模块，社区医院可优先实现基础预约功能。")])])}),[],!1,null,null,null);s.default=e.exports}}]);